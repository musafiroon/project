<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chrome Clone</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Chrome-specific custom styles */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; overflow: hidden; }
        
        .tab-shape {
            position: relative;
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
            z-index: 1;
        }
        
        .tab-shape::before, .tab-shape::after {
            content: '';
            position: absolute;
            bottom: 0;
            width: 20px;
            height: 10px;
            border-radius: 0 0 10px 0; /* Corner smoothing */
        }
        
        .active-tab {
            background-color: white;
            z-index: 10;
        }
        
        .active-tab::before {
            left: -10px;
            background: radial-gradient(circle at 0 0, transparent 10px, white 10px);
        }
        
        .active-tab::after {
            right: -10px;
            background: radial-gradient(circle at 100% 0, transparent 10px, white 10px);
        }

        .inactive-tab:hover {
            background-color: #f3f4f6;
        }

        .omnibox-shadow:focus-within {
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            background-color: white;
            border-color: #3b82f6;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #c1c1c1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #a8a8a8; }
        
        .iframe-container {
            width: 100%;
            height: calc(100vh - 112px); /* Adjust for header height */
            border: none;
        }
    </style>
</head>
<body class="bg-gray-100 h-screen w-screen flex flex-col">
    <div id="root" class="h-full flex flex-col"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- Icons (SVGs) ---
        const Icons = {
            ArrowLeft: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>,
            ArrowRight: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>,
            RotateCw: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><path d="M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/></svg>,
            Home: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>,
            Star: () => <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>,
            MoreVertical: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="1"/><circle cx="12" cy="5" r="1"/><circle cx="12" cy="19" r="1"/></svg>,
            Plus: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M5 12h14"/><path d="M12 5v14"/></svg>,
            X: () => <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M18 6 6 18"/><path d="m6 6 18 18"/></svg>,
            Search: () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#6b7280" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>,
            Lock: () => <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#16a34a" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="18" height="11" x="3" y="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>,
            Globe: () => <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#6b7280" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><line x1="2" x2="22" y1="12" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>,
            Puzzle: () => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19.439 15.424c-2.43 0-4.14-1.296-4.14-3.134 0-2.467 2.29-3.237 4.14-3.237a.8.8 0 0 0 .786-1.018l-1.07-4.162a.8.8 0 0 0-1.116-.54l-3.953 1.58c-.96.384-2.028.163-2.675-.713l-1.353-1.832a.8.8 0 0 0-1.218-.088l-3.208 3.208a.8.8 0 0 0-.088 1.218l1.832 1.353c.876.647 1.097 1.715.713 2.675l-1.58 3.953a.8.8 0 0 0 .54 1.116l4.162 1.07a.8.8 0 0 0 1.018-.786c0-1.85 .77-4.14 3.237-4.14 1.838 0 3.134 1.71 3.134 4.14a.8.8 0 0 0 .786 1.018l4.162-1.07a.8.8 0 0 0 .54-1.116l-1.58-3.953a.8.8 0 0 0-1.116-.54z"/></svg>,
            UserCircle: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="10" r="3"/><path d="M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662"/></svg>
        };

        const INITIAL_TAB_ID = 'tab-' + Date.now();
        const DEFAULT_URL = 'chrome://newtab';

        // Helper to determine if URL is safe/valid for iframe
        // Note: Real browsers block iframing for most major sites (Google, FB, etc.) due to X-Frame-Options.
        // This is a limitation of the "web inside web" model.
        const processUrl = (input) => {
            if (!input) return DEFAULT_URL;
            if (input.startsWith('chrome://')) return input;
            
            let url = input;
            if (!url.startsWith('http://') && !url.startsWith('https://')) {
                // If it looks like a domain, prepend https
                if (url.includes('.') && !url.includes(' ')) {
                    url = 'https://' + url;
                } else {
                    // It's a search query
                    return `https://www.bing.com/search?q=${encodeURIComponent(url)}`;
                }
            }
            return url;
        };

        // --- Internal Page Components ---

        const NewTabPage = ({ onNavigate }) => {
            const [query, setQuery] = useState('');

            const handleSearch = (e) => {
                e.preventDefault();
                onNavigate(processUrl(query));
            };

            const shortcuts = [
                { name: 'Wikipedia', url: 'https://www.wikipedia.org', icon: 'W', color: 'bg-gray-200' },
                { name: 'Bing', url: 'https://www.bing.com', icon: 'B', color: 'bg-blue-100' },
                { name: 'Example', url: 'https://www.example.com', icon: 'E', color: 'bg-green-100' },
                { name: 'Learn React', url: 'https://react.dev', icon: 'R', color: 'bg-gray-800 text-white' }
            ];

            return (
                <div className="flex flex-col items-center justify-center min-h-[80vh] bg-white animate-fade-in">
                    <div className="mb-8 transform scale-125 font-bold text-5xl text-gray-700 tracking-tighter">
                        <span className="text-blue-500">G</span>
                        <span className="text-red-500">o</span>
                        <span className="text-yellow-400">o</span>
                        <span className="text-blue-500">g</span>
                        <span className="text-green-500">l</span>
                        <span className="text-red-500">e</span>
                    </div>
                    
                    <form onSubmit={handleSearch} className="w-full max-w-xl px-4">
                        <div className="relative group">
                            <div className="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                                <Icons.Search />
                            </div>
                            <input
                                type="text"
                                value={query}
                                onChange={(e) => setQuery(e.target.value)}
                                className="w-full py-3 pl-12 pr-12 text-gray-700 bg-white border border-gray-200 rounded-full shadow-sm hover:shadow-md focus:shadow-md focus:outline-none transition-shadow"
                                placeholder="Search Google or type a URL"
                                autoFocus
                            />
                            <div className="absolute inset-y-0 right-0 pr-4 flex items-center cursor-pointer">
                                <img src="https://www.gstatic.com/images/branding/googlemic/2x/googlemic_color_24dp.png" alt="voice" className="h-6" />
                            </div>
                        </div>
                    </form>

                    <div className="grid grid-cols-4 gap-4 mt-8">
                        {shortcuts.map((site) => (
                            <button 
                                key={site.url}
                                onClick={() => onNavigate(site.url)}
                                className="flex flex-col items-center p-4 rounded-lg hover:bg-gray-100 transition-colors gap-3"
                            >
                                <div className={`w-12 h-12 rounded-full flex items-center justify-center text-xl font-bold ${site.color}`}>
                                    {site.icon}
                                </div>
                                <span className="text-sm text-gray-700">{site.name}</span>
                            </button>
                        ))}
                    </div>
                    
                    <div className="mt-12 p-4 bg-yellow-50 border border-yellow-200 rounded-lg max-w-2xl text-sm text-yellow-800">
                        <strong>Developer Note:</strong> This is a browser simulation ("clone") running inside a browser. 
                        Many modern websites (like Google.com, YouTube) have security settings (`X-Frame-Options`) that prevent them from loading inside this window. 
                        Try <strong>Wikipedia</strong>, <strong>Bing</strong>, or <strong>Example.com</strong> for best results.
                    </div>
                </div>
            );
        };

        const EmptyState = ({ url }) => (
            <div className="flex flex-col items-center justify-center h-full bg-white text-gray-500">
                <div className="text-6xl mb-4">â˜¹</div>
                <h2 className="text-xl font-medium text-gray-800">This content is blocked.</h2>
                <p className="mt-2 max-w-md text-center">
                    The website <strong>{url}</strong> does not allow itself to be displayed in a frame (Cross-Origin Policy). 
                </p>
                <a href={url} target="_blank" className="mt-4 text-blue-600 hover:underline">Open in real tab instead</a>
            </div>
        );

        // --- Main App Component ---

        const App = () => {
            const [tabs, setTabs] = useState([{ 
                id: INITIAL_TAB_ID, 
                title: 'New Tab', 
                url: DEFAULT_URL, 
                history: [DEFAULT_URL], 
                historyIndex: 0,
                favicon: null
            }]);
            const [activeTabId, setActiveTabId] = useState(INITIAL_TAB_ID);
            const [urlInput, setUrlInput] = useState('');
            const [isMenuOpen, setIsMenuOpen] = useState(false);

            // Get active tab object
            const activeTab = tabs.find(t => t.id === activeTabId) || tabs[0];

            useEffect(() => {
                // Update URL bar when switching tabs
                if (activeTab.url === DEFAULT_URL) {
                    setUrlInput('');
                } else {
                    setUrlInput(activeTab.url);
                }
            }, [activeTabId, activeTab.url]);

            const createTab = () => {
                const newId = 'tab-' + Date.now();
                setTabs([...tabs, { 
                    id: newId, 
                    title: 'New Tab', 
                    url: DEFAULT_URL, 
                    history: [DEFAULT_URL],
                    historyIndex: 0
                }]);
                setActiveTabId(newId);
            };

            const closeTab = (e, tabId) => {
                e.stopPropagation();
                if (tabs.length === 1) {
                    // Don't close last tab, just reset it
                    updateTab(tabId, { url: DEFAULT_URL, title: 'New Tab', history: [DEFAULT_URL], historyIndex: 0 });
                    return;
                }
                
                const newTabs = tabs.filter(t => t.id !== tabId);
                setTabs(newTabs);
                if (activeTabId === tabId) {
                    setActiveTabId(newTabs[newTabs.length - 1].id);
                }
            };

            const updateTab = (id, updates) => {
                setTabs(prev => prev.map(t => t.id === id ? { ...t, ...updates } : t));
            };

            const navigateTo = (url) => {
                const processedUrl = processUrl(url);
                
                // Update History
                const newHistory = activeTab.history.slice(0, activeTab.historyIndex + 1);
                newHistory.push(processedUrl);

                updateTab(activeTabId, { 
                    url: processedUrl, 
                    title: processedUrl.replace('https://', '').replace('http://', '').split('/')[0] || 'Page',
                    history: newHistory,
                    historyIndex: newHistory.length - 1
                });
            };

            const goBack = () => {
                if (activeTab.historyIndex > 0) {
                    const newIndex = activeTab.historyIndex - 1;
                    const newUrl = activeTab.history[newIndex];
                    updateTab(activeTabId, { url: newUrl, historyIndex: newIndex });
                }
            };

            const goForward = () => {
                if (activeTab.historyIndex < activeTab.history.length - 1) {
                    const newIndex = activeTab.historyIndex + 1;
                    const newUrl = activeTab.history[newIndex];
                    updateTab(activeTabId, { url: newUrl, historyIndex: newIndex });
                }
            };

            const handleUrlSubmit = (e) => {
                e.preventDefault();
                navigateTo(urlInput);
            };

            const handleIframeLoad = (e) => {
                // Try to extract title if same-origin (unlikely for external sites, but good practice)
                try {
                    const title = e.target.contentDocument.title;
                    if (title) updateTab(activeTabId, { title });
                } catch (err) {
                    // Cross-origin error expected
                }
            };

            return (
                <div className="flex flex-col h-full bg-[#dfe9f3]">
                    {/* --- Title Bar / Tabs --- */}
                    <div className="flex pt-2 px-2 gap-1 items-end overflow-x-auto select-none" style={{ background: '#dfe9f3' }}>
                        {tabs.map(tab => (
                            <div 
                                key={tab.id}
                                onClick={() => setActiveTabId(tab.id)}
                                className={`
                                    group relative flex items-center min-w-[160px] max-w-[240px] h-[34px] px-3 text-xs 
                                    cursor-default transition-all duration-100 tab-shape
                                    ${activeTabId === tab.id ? 'active-tab text-gray-800' : 'inactive-tab text-gray-600'}
                                `}
                            >
                                <div className="flex items-center gap-2 flex-1 overflow-hidden">
                                    {tab.url === DEFAULT_URL ? <Icons.ArrowRight /> : <Icons.Globe />} 
                                    <span className="truncate flex-1">{tab.title}</span>
                                </div>
                                <button 
                                    onClick={(e) => closeTab(e, tab.id)}
                                    className={`ml-1 p-1 rounded-full hover:bg-gray-200 ${activeTabId === tab.id ? 'opacity-100' : 'opacity-0 group-hover:opacity-100'}`}
                                >
                                    <Icons.X />
                                </button>
                            </div>
                        ))}
                        <button 
                            onClick={createTab}
                            className="p-1.5 ml-1 rounded-full hover:bg-gray-300 text-gray-700 transition-colors"
                        >
                            <Icons.Plus />
                        </button>
                    </div>

                    {/* --- Navigation Bar --- */}
                    <div className="bg-white px-2 py-1.5 flex items-center gap-2 border-b border-gray-200 shadow-sm z-20">
                        <div className="flex gap-1 text-gray-600">
                            <button onClick={goBack} disabled={activeTab.historyIndex === 0} className="p-1.5 rounded-full hover:bg-gray-100 disabled:opacity-30 disabled:hover:bg-transparent">
                                <Icons.ArrowLeft />
                            </button>
                            <button onClick={goForward} disabled={activeTab.historyIndex === activeTab.history.length - 1} className="p-1.5 rounded-full hover:bg-gray-100 disabled:opacity-30 disabled:hover:bg-transparent">
                                <Icons.ArrowRight />
                            </button>
                            <button onClick={() => navigateTo(activeTab.url)} className="p-1.5 rounded-full hover:bg-gray-100">
                                <Icons.RotateCw />
                            </button>
                        </div>

                        <form onSubmit={handleUrlSubmit} className="flex-1 flex">
                            <div className="omnibox-shadow flex items-center w-full bg-gray-100 rounded-full px-3 py-1.5 border border-transparent transition-all">
                                <div className="mr-2 text-gray-500">
                                    {activeTab.url.startsWith('https') ? <Icons.Lock /> : (activeTab.url === DEFAULT_URL ? <Icons.Search /> : <Icons.Globe />)}
                                </div>
                                <input 
                                    type="text" 
                                    value={urlInput}
                                    onChange={(e) => setUrlInput(e.target.value)}
                                    onFocus={(e) => e.target.select()}
                                    className="flex-1 bg-transparent border-none outline-none text-sm text-gray-700"
                                    placeholder="Search Google or type a URL"
                                />
                                <div className="ml-2">
                                    <Icons.Star />
                                </div>
                            </div>
                        </form>

                        <div className="flex gap-1 text-gray-600 relative">
                             {/* Extensions area simulation */}
                            <button className="p-1.5 rounded-full hover:bg-gray-100">
                                <Icons.Puzzle />
                            </button>
                            
                             {/* Profile */}
                            <button className="p-1 rounded-full hover:bg-gray-100">
                                <Icons.UserCircle />
                            </button>

                            {/* Menu */}
                            <button onClick={() => setIsMenuOpen(!isMenuOpen)} className="p-1.5 rounded-full hover:bg-gray-100">
                                <Icons.MoreVertical />
                            </button>
                            
                            {isMenuOpen && (
                                <div className="absolute top-10 right-0 w-64 bg-white rounded-lg shadow-xl border py-2 text-sm text-gray-700 z-50">
                                    <div className="px-4 py-2 hover:bg-gray-100 cursor-pointer flex justify-between">
                                        <span>New Tab</span>
                                        <span className="text-gray-400">Ctrl+T</span>
                                    </div>
                                    <div className="px-4 py-2 hover:bg-gray-100 cursor-pointer flex justify-between">
                                        <span>New Window</span>
                                        <span className="text-gray-400">Ctrl+N</span>
                                    </div>
                                    <div className="h-px bg-gray-200 my-1"></div>
                                    <div className="px-4 py-2 hover:bg-gray-100 cursor-pointer flex justify-between">
                                        <span>History</span>
                                    </div>
                                    <div className="px-4 py-2 hover:bg-gray-100 cursor-pointer flex justify-between">
                                        <span>Downloads</span>
                                    </div>
                                    <div className="px-4 py-2 hover:bg-gray-100 cursor-pointer flex justify-between">
                                        <span>Bookmarks</span>
                                    </div>
                                    <div className="h-px bg-gray-200 my-1"></div>
                                    <div className="px-4 py-2 hover:bg-gray-100 cursor-pointer flex justify-between">
                                        <span>Settings</span>
                                    </div>
                                    <div className="px-4 py-2 hover:bg-gray-100 cursor-pointer flex justify-between" onClick={() => setIsMenuOpen(false)}>
                                        <span>Help</span>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                    
                    {/* --- Bookmarks Bar --- */}
                    <div className="bg-white px-3 py-1 flex items-center gap-4 text-xs text-gray-600 border-b border-gray-200">
                        <button onClick={() => navigateTo(DEFAULT_URL)} className="hover:bg-gray-200 px-2 py-1 rounded flex items-center gap-1">
                            <span className="w-3 h-3 rounded-full bg-blue-400"></span> New Tab
                        </button>
                        <button onClick={() => navigateTo('https://www.wikipedia.org')} className="hover:bg-gray-200 px-2 py-1 rounded flex items-center gap-1">
                            <img src="https://www.wikipedia.org/static/favicon/wikipedia.ico" className="w-3 h-3" alt="" /> Wikipedia
                        </button>
                        <button onClick={() => navigateTo('https://bing.com')} className="hover:bg-gray-200 px-2 py-1 rounded flex items-center gap-1">
                            <span className="w-3 h-3 rounded-full bg-blue-600"></span> Bing
                        </button>
                        <button onClick={() => navigateTo('https://archive.org')} className="hover:bg-gray-200 px-2 py-1 rounded flex items-center gap-1">
                            <span className="w-3 h-3 rounded-full bg-gray-600"></span> Archive
                        </button>
                    </div>

                    {/* --- Viewport (Content) --- */}
                    <div className="flex-1 relative bg-white">
                        {tabs.map(tab => (
                            <div 
                                key={tab.id} 
                                className={`absolute inset-0 w-full h-full ${activeTabId === tab.id ? 'block' : 'hidden'}`}
                            >
                                {tab.url === DEFAULT_URL ? (
                                    <NewTabPage onNavigate={navigateTo} />
                                ) : (
                                    <iframe 
                                        src={tab.url}
                                        className="iframe-container"
                                        onLoad={handleIframeLoad}
                                        sandbox="allow-same-origin allow-scripts allow-forms allow-popups"
                                    />
                                )}
                            </div>
                        ))}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
